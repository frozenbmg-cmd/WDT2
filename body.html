
<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Fitness App ‚Äî Body</title>
<link rel="manifest" href="manifest.json">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<link rel="apple-touch-icon" href="icon-192.png">
<style>
:root{--bg:#0f1724;--card:rgba(255,255,255,0.08);--muted:rgba(255,255,255,0.65);--accent:#7c3aed;color-scheme:dark;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto;}
body{margin:0;min-height:100vh;background:var(--bg);color:#fff;padding:20px}
.wrap{max-width:800px;margin:0 auto;padding-bottom:80px}
header{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}
.card{background:var(--card);padding:18px;border-radius:12px;margin-bottom:20px}
.log-form input, .log-form select { width:100%; padding:10px; margin-bottom:12px; border-radius:8px; border:1px solid rgba(255,255,255,0.06); background:rgba(255,255,255,0.03); color:#fff; }
.btn { padding:12px; border-radius:8px; border:none; background:var(--accent); color:#fff; font-weight:700; cursor:pointer; }
.suggestion { border-left:4px solid var(--accent); padding-left:12px; background: rgba(124,58,237,0.02); margin-top:12px; border-radius:8px; }
.nav { position:fixed; bottom:0; left:0; right:0; height:65px; background:#1E1E1E; display:flex; justify-content:space-around; align-items:center; box-shadow:0 -2px 15px rgba(0,0,0,0.6); border-top-left-radius:15px; border-top-right-radius:15px; }
.nav a { text-decoration:none; color:#fff }
</style>
</head>
<body>
<div class="wrap">
  <header><h1>Body Metrics</h1><a href="index.html" style="color:#fff;text-decoration:none;">‚Üê Dashboard</a></header>

  <div class="card">
    <h2>Your Profile</h2>
    <form id="profileForm" class="log-form" onsubmit="applyProfile(event)">
      <label>Age</label><input id="age" type="number" min="10" required>
      <label>Sex</label><select id="sex"><option value="male">Male</option><option value="female">Female</option></select>
      <label>Height (cm)</label><input id="height" type="number" min="100" required>
      <label>Weight (kg)</label><input id="weight" type="number" step="0.1" min="20" required>
      <label>Activity level</label><select id="activity"><option value="1.2">Sedentary</option><option value="1.375">Light</option><option value="1.55">Moderate</option><option value="1.725">Very Active</option><option value="1.9">Extremely</option></select>
      <div style="display:flex; gap:10px;"><button class="btn" type="submit">Apply</button><button type="button" class="btn" style="background:#333" onclick="loadSample()">Load Sample</button></div>
    </form>
  </div>

  <div class="card">
    <h2>Results</h2>
    <div id="results">
      <p><strong>BMR:</strong> <span id="bmrVal">‚Äî</span> kcal/day</p>
      <p><strong>TDEE:</strong> <span id="tdeeVal">‚Äî</span> kcal/day</p>
      <p><strong>BMI:</strong> <span id="bmiVal">‚Äî</span> <span id="bmiCat" style="margin-left:8px;color:#fff"></span></p>
    </div>

    <div class="suggestion" id="dietSuggestion" style="display:none">
      <h3>Suggested Daily Calories & Sample Meals</h3>
      <div id="calTargets"></div>
      <h4 style="margin-top:10px">Sample quick meals (editable)</h4>
      <div id="sampleMeals"></div>
    </div>
  </div>
</div>

<div class="nav">
    <a href="index.html">üè† Home</a>
    <a href="heart.html">‚ù§Ô∏è Heart</a>
    <a href="workouts.html">üí™ Workouts</a>
</div>

<script>
// Persistence
const KEY = 'fitness_body_profile';
let profile = {};

function calculateBMR({age, sex, weight, height}){
  if(sex==='male') return Math.round(88.362 + (13.397 * weight) + (4.799 * height) - (5.677 * age));
  return Math.round(447.593 + (9.247 * weight) + (3.098 * height) - (4.330 * age));
}

function calculateBMI(weight, heightCm){
  if(!weight || !heightCm) return null;
  const h = heightCm/100;
  return weight / (h*h);
}

function bmiCategory(bmi){
  if(bmi<18.5) return 'Underweight';
  if(bmi<24.9) return 'Healthy';
  if(bmi<29.9) return 'Overweight';
  return 'Obese';
}

function suggestDiet(tdee){
  // three tiers: maintain, mild deficit, mild surplus
  const maintain = tdee;
  const mildLoss = Math.max(1200, Math.round(tdee - 500));
  const mildGain = Math.round(tdee + 300);
  return {maintain, mildLoss, mildGain};
}

function sampleMealsForCalories(cal){
  // very simple templated sample meals based on calories
  if(cal <= 1500){
    return [
      {name:'Oatmeal + Banana + Milk', kcal:400},
      {name:'Grilled Chicken Salad', kcal:450},
      {name:'Greek Yogurt + Nuts', kcal:200},
      {name:'Light Dinner: Veg + Fish', kcal:350}
    ];
  } else if(cal <= 2200){
    return [
      {name:'Eggs + Toast + Fruit', kcal:550},
      {name:'Chicken Rice + Veg', kcal:700},
      {name:'Protein Shake', kcal:300},
      {name:'Dinner: Paneer/Tofu + Rice', kcal:600}
    ];
  } else {
    return [
      {name:'Smoothie + Oats + Peanut Butter', kcal:700},
      {name:'Beef/Chicken + Rice + Veg', kcal:900},
      {name:'Nuts + Protein Shake', kcal:400},
      {name:'High-Cal Dinner: Pasta + Protein', kcal:700}
    ];
  }
}

function renderResults(){
  const bmr = calculateBMR(profile);
  const tdee = Math.round(bmr * profile.activity);
  const bmi = calculateBMI(profile.weight, profile.height);
  document.getElementById('bmrVal').innerText = bmr;
  document.getElementById('tdeeVal').innerText = tdee;
  document.getElementById('bmiVal').innerText = bmi ? bmi.toFixed(1) : '‚Äî';
  document.getElementById('bmiCat').innerText = bmi ? `(${bmiCategory(bmi)})` : '';
  const targets = suggestDiet(tdee);
  const suggestion = document.getElementById('dietSuggestion');
  suggestion.style.display = 'block';
  const ct = document.getElementById('calTargets');
  ct.innerHTML = `
    <div><strong>Maintain:</strong> ${targets.maintain} kcal/day</div>
    <div><strong>For weight loss (safe):</strong> ${targets.mildLoss} kcal/day</div>
    <div><strong>For weight gain:</strong> ${targets.mildGain} kcal/day</div>
  `;
  const meals = sampleMealsForCalories(targets.maintain);
  const sm = document.getElementById('sampleMeals');
  sm.innerHTML = '';
  meals.forEach(m => {
    const el = document.createElement('div');
    el.contentEditable = true;
    el.style.padding = '8px';
    el.style.marginBottom = '6px';
    el.style.background = 'rgba(255,255,255,0.03)';
    el.style.borderRadius = '6px';
    el.innerText = `${m.name} ‚Äî ${m.kcal} kcal`;
    sm.appendChild(el);
  });
}

function applyProfile(e){
  e && e.preventDefault();
  const age = parseInt(document.getElementById('age').value);
  const sex = document.getElementById('sex').value;
  const height = parseFloat(document.getElementById('height').value);
  const weight = parseFloat(document.getElementById('weight').value);
  const activity = parseFloat(document.getElementById('activity').value);
  profile = {age, sex, height, weight, activity};
  localStorage.setItem(KEY, JSON.stringify(profile));
  renderResults();
}

function loadFromStorage(){
  const saved = localStorage.getItem(KEY);
  if(saved){ profile = JSON.parse(saved); document.getElementById('age').value = profile.age; document.getElementById('sex').value = profile.sex; document.getElementById('height').value = profile.height; document.getElementById('weight').value = profile.weight; document.getElementById('activity').value = profile.activity; renderResults(); }
}

function loadSample(){
  document.getElementById('age').value = 30;
  document.getElementById('sex').value = 'male';
  document.getElementById('height').value = 175;
  document.getElementById('weight').value = 76.5;
  document.getElementById('activity').value = 1.55;
  applyProfile();
}

// register service worker
if ('serviceWorker' in navigator) { navigator.serviceWorker.register('sw.js').catch(()=>{}); }

document.addEventListener('DOMContentLoaded', loadFromStorage);
</script>
</body>
</html>
